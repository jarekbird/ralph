services:
  ralph:
    build:
      context: .
    # Mount the target project (where your PRD lives) into /workspace.
    # Set WORKSPACE_DIR to an absolute path when running docker compose.
    volumes:
      - ${WORKSPACE_DIR:-..}:/workspace
      # Provide Cursor Agent CLI to the container (recommended).
      # Set CURSOR_AGENT_BIN to the absolute path of your host `agent` binary.
      # Example (macOS): export CURSOR_AGENT_BIN=/Users/you/.local/bin/agent
      - ${CURSOR_AGENT_BIN:-/usr/local/bin/agent}:/usr/local/bin/agent:ro
    environment:
      - CURSOR_API_KEY
      # Default to the mounted agent binary unless overridden at runtime
      - RALPH_CURSOR_BIN=agent
    working_dir: /workspace
